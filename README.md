# CSCSO – Code and Supplementary Numerical Experiments

This repository contains all Python codes used to produce the numerical experiments in the paper:
[Contextual Strongly Convex Simulation Optimization: Optimize then Predict with Inexact Solutions]

The project contains:
- Pilot experiment for selecting the pilot parameter bar(T)，
- Experiment 1 (EX1): Allocation rule comparison，
- Experiment 2 (EX2): Convergence rate evaluation，together with all saved results generated by the scripts.

## Pilot $\bar{T}$ selection

Folder: Pilot $\bar{T}$ selection/

Purpose: select pilot $\bar{T}$, under which the relative optimality gap is below 2%, to construct benchmark rules.

Files:
- select bar T.py — main script for selecting the pilot parameter bar(T)
- functions.py — helper functions


## EX1 – Allocation Rule Comparision

Folder: EX1_Allocation Rule/

Purpose: compare different sample allocation rules under different covariate dimensions.

Main files:
- LR_all.py
- KRR_all.py
- KS_all.py
- kNN_all.py
- functions.py
- existing result folders: 2d/, 10d/

### Configurable parameters in EX1

Each EX1 script contains the following block:

- d = 2 # Options: 2 or 10
- rule = 'opt' # Options: 'opt', 'exact', 'under', 'over'

Meaning of parameters:

- d : covariate dimension, allowed values 2 or 10

- rule = 'opt' : our derived optimal allocation rule
- rule = 'exact' : T = bar(T)
- rule = 'under' : T = 0.5 * bar(T)
- rule = 'over' : T = 1.5 * bar(T)

### Output structure in EX1

Every EX1 script uses the following saving structure:

`save_dir = EX1_Allocation Rule/<d>d/<method>/<rule>/`

opt_values_test.npy is saved under:

`EX1_Allocation Rule/<d>d/opt_values_test.npy`,
which are the true optimal value.

For each smoothing technique, allocation rule, total budget, and the corresponding allocation, the raw relative optimality gaps for 100 replications (each replication evaluated at 100 test covariates) are saved using:

`save_path = os.path.join(save_dir, str(Gamma) + '' + str(n) + '' + str(T) + '.npy')`

Inside save_dir, a file named results.csv is created, which contains the columns:
Gamma, n, T, average, sd, min, max

Existing folders 2d/ and 10d/ in this directory already contain the saved results.

### Additional Notes on Stored Results

EX1_results_all.xlsx

The file EX1_results_all.xlsx stores, for every smoothing technique (LR, KRR, KS, kNN) and every allocation rule (opt, exact, under, over), the following four summary statistics of the relative optimality gaps:
- the mean
- the standard deviation
- the minimum
- the maximum，
as well as Gamma and (n,T).

The computation is based on 100 online test covariate.
This corresponds to Table 2 inthe paper, which reports the mean relative optimality gaps for selected budget levels 


## EX2 – Convergence Rate 

Folder: EX2_Convergence Rate/

Purpose: evaluate convergence rate under different combinations of the decision variable dimension q and covariate dimension d.

Main files:
- 2_LR.py
- 2_KRR.py
- 2_KS.py
- 2_kNN.py
- functions.py
- existing results folders: 10d/, 50d/
- Figure/ (xlsx, pdf figure, notebook)

### Configurable parameters in EX2

Each EX2 script contains:

- q = 5 # Options: 5 or 25
- d = 10 # Options: 10 or 50

Valid combinations used in the experiments:
(q, d) = (5, 10), (25, 10), (5, 50)

Meaning:

q : dimension of the decision variable
d : covariate dimension

### Output structure in EX2

Results are saved under:

`EX2_Convergence Rate/<d>d/<q>q/<method>/results.csv`

`EX2_Convergence Rate/<d>d/<q>q/opt_values_test.npy`

opt_values_test.npy saves true optimal value.

The EX2 results.csv contains:

Gamma, n, T, mean

Existing folders 10d/ and 50d/ already contain previously generated EX2 results.

### Additional Notes on Stored Results
EX2_results_all.xlsx

The file EX2_results_all.xlsx stores, for each pair (q,d) and each smoothing technique, the average relative optimality gap computed over 100 replications at a fixed test covariate.
These values correspond to the experiment used to visualize convergence rates.
The Jupyter notebook in the Figure/ folder loads this file and produces the convergence plots shown as Figure 1 in the paper.

## Dependencies

Recommended environment packages:

numpy
scipy
pandas
matplotlib
seaborn
scikit-learn
tqdm
openpyxl
jupyter

